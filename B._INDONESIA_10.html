<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ujian B. INDONESIA 10</title>
<style>
  body, html { margin:0; padding:0; height:100%; overflow:hidden; font-family:sans-serif; }
  iframe { width:100%; height:100%; border:none; }
  .modal {
    display:none; position:fixed; top:0; left:0;
    width:100%; height:100%; background: rgba(0,0,0,0.7);
    justify-content:center; align-items:center; z-index:1000;
  }
  .modal-content {
    background:#fff; padding:20px; border-radius:10px;
    text-align:center; max-width:90%;
  }
  .modal-content button {
    margin-top:15px; padding:10px 20px; border:none;
    background:#007BFF; color:#fff; border-radius:5px;
    font-size:16px;
  }
</style>
</head>
<body>
<iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfqfZUv6p0_k0IbAozo19lFsReABYgyhmAHUcJcsKK4havbfw/viewform?usp=header" id="examFrame"></iframe>

<div id="peringatanModal" class="modal">
  <div class="modal-content">
    <p id="peringatanText">Peringatan!</p>
    <button onclick="tutupModal()">OK</button>
  </div>
</div>

<script>
let pelanggaran = parseInt(localStorage.getItem('B. INDONESIA 10_pelanggaran')) || 0;
const modal = document.getElementById('peringatanModal');
const teks = document.getElementById('peringatanText');

function showModal(msg){ 
  teks.textContent = msg; 
  modal.style.display = 'flex'; 
}
function tutupModal(){ modal.style.display = 'none'; }

// ðŸ”¹ Deteksi pindah tab
document.addEventListener('visibilitychange', () => {
  if(document.hidden){
    pelanggaran++;
    localStorage.setItem('B. INDONESIA 10_pelanggaran', pelanggaran);
    if(pelanggaran >= 3){
      window.location.href = "akses_ditutup.html";
    } else {
      showModal(`Peringatan! Anda sudah ${pelanggaran} kali mencoba meninggalkan tab ujian.`);
    }
  }
});

// ðŸ”¹ Deteksi coba keluar / buka link lain di tab yang sama
window.addEventListener("beforeunload", (event) => {
  pelanggaran++;
  localStorage.setItem('B. INDONESIA 10_pelanggaran', pelanggaran);
  if(pelanggaran >= 3){
    window.location.href = "akses_ditutup.html";
  } else {
    showModal(`Peringatan! Anda mencoba meninggalkan halaman ujian. Pelanggaran ke-${pelanggaran}`);
  }
  event.preventDefault();
  event.returnValue = "";
});

// ðŸ”¹ Paksa fullscreen saat mulai
function openFullscreen() {
  const elem = document.documentElement;
  if (elem.requestFullscreen) elem.requestFullscreen();
  else if (elem.mozRequestFullScreen) elem.mozRequestFullScreen();
  else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
  else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
}
openFullscreen();

// ðŸ”¹ Deteksi keluar fullscreen
document.addEventListener("fullscreenchange", () => {
  if (!document.fullscreenElement) {
    pelanggaran++;
    localStorage.setItem('B. INDONESIA 10_pelanggaran', pelanggaran);
    if(pelanggaran >= 3){
      window.location.href = "akses_ditutup.html";
    } else {
      showModal(`Jangan keluar dari fullscreen! Pelanggaran ke-${pelanggaran}`);
      openFullscreen(); // paksa masuk fullscreen lagi
    }
  }
});

// ðŸ”¹ Nonaktifkan klik kanan
document.addEventListener('contextmenu', e => e.preventDefault());
</script>
</body>
</html>
